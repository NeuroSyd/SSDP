import matplotlib.pyplot as plt
import seaborn as sns

# 平均损失数据（100个Epoch的平均损失）
average_losses = [
    0.4414, 0.4028, 0.3448, 0.3309, 0.3294, 0.3311, 0.3049, 0.2952, 0.2900, 0.3215,
    0.3383, 0.2682, 0.3415, 0.2717, 0.2751, 0.3054, 0.2703, 0.2792, 0.2779, 0.2784,
    0.2539, 0.2706, 0.2962, 0.2809, 0.2775, 0.2836, 0.2738, 0.2846, 0.2725, 0.2717,
    0.3108, 0.2476, 0.2690, 0.2457, 0.3027, 0.2501, 0.2489, 0.2819, 0.2724, 0.2504,
    0.2716, 0.2702, 0.2426, 0.2612, 0.2279, 0.2358, 0.2296, 0.2286, 0.2233, 0.2257,
    0.2437, 0.2335, 0.2234, 0.2234, 0.2230, 0.2222, 0.2209, 0.2199, 0.2178, 0.2154,
    0.2148, 0.2143, 0.2138, 0.2123, 0.2112, 0.2104, 0.2095, 0.2077, 0.2064, 0.2055,
    0.2050, 0.2046, 0.2038, 0.2031, 0.2024, 0.2017, 0.2011, 0.2008, 0.2005, 0.1999,
    0.1993, 0.1988, 0.1983, 0.1977, 0.1971, 0.1966, 0.1960, 0.1954, 0.1948, 0.1942,
    0.1935, 0.1929, 0.1924, 0.1919, 0.1914, 0.1908, 0.1903, 0.1897, 0.1891, 0.1886
]

average_losses2 = [
    0.5253, 0.4353, 0.3768, 0.3564, 0.3251, 0.3288, 0.2968, 0.2545, 0.3502, 0.2995,
    0.3023, 0.2695, 0.2993, 0.2634, 0.2761, 0.2699, 0.2665, 0.2545, 0.2766, 0.2586,
    0.2557, 0.2526, 0.2968, 0.2646, 0.2505, 0.2471, 0.2925, 0.2331, 0.2328, 0.2505,
    0.2364, 0.2323, 0.2259, 0.2184, 0.2758, 0.2227, 0.2339, 0.2532, 0.2154, 0.2034,
    0.2254, 0.2356, 0.2264, 0.2017, 0.2137, 0.2049, 0.2232, 0.1936, 0.1920, 0.1977,
    0.2098, 0.2060, 0.2263, 0.1869, 0.2041, 0.1791, 0.1936, 0.1970, 0.1962, 0.1799,
    0.1706, 0.2025, 0.1643, 0.1653, 0.1763, 0.1714, 0.1551, 0.1613, 0.1767, 0.1708,
    0.1708, 0.1579, 0.1513, 0.1388, 0.1429, 0.1338, 0.1342, 0.1398, 0.1359, 0.1316,
    0.1296, 0.1207, 0.1045, 0.1210, 0.1171, 0.1203, 0.1134, 0.1124, 0.1094, 0.1090,
    0.1057, 0.1062, 0.1045, 0.1018, 0.1021, 0.1000, 0.1000, 0.0985, 0.0979, 0.0974
]

# 设置Seaborn样式
# sns.set(style="whitegrid", context="talk", palette="deep")

# 创建图形和轴
plt.figure(figsize=(14, 8))

# 绘制average_losses（SSDP 曲线）
plt.plot(
    range(1, 101),
    average_losses,
    marker='o',          # 圆形标记
    linestyle='-',       # 实线
    linewidth=3,         # 加粗线条
    markersize=8,        # 增大标记大小
    color='steelblue',   # 保留原有颜色
    label='SSDP(Test Acc:89.37)'
)

# 绘制average_losses2（without_SSDP 曲线）
plt.plot(
    range(1, 101),
    average_losses2,
    marker='^',          # 三角形标记
    linestyle='--',      # 虚线
    linewidth=5,         # 加粗线条
    markersize=12,        # 增大标记大小
    color='darkorange',  # 保留原有颜色
    label='Without SSDP(Test Acc:88.74)'
)

# 添加轴标签
plt.xlabel("Epoch", fontsize=36)
plt.ylabel("Training Loss", fontsize=36)

# 设置刻度字体大小
plt.xticks(fontsize=30)
plt.yticks(fontsize=30)

# 设置x轴的范围
plt.xlim(1, 100)

# 添加网格
# plt.grid(True, which='both', linestyle='--', linewidth=0.5, alpha=0.7)

# 添加图例
plt.legend(loc='upper right', prop={'size': 30, 'weight': 'bold'})


# 优化布局
plt.tight_layout()

# 保存为矢量图格式（SVG和PDF）
plt.savefig("average_loss_plot.svg", format='svg')
plt.savefig("average_loss_plot.pdf", format='pdf')

# 显示图形
plt.show()
